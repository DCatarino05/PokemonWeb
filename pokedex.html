<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pokédex</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body class="index-body">
  <div id="video-background">
    <video autoplay loop muted class="video-background">
      <source src="/images/fundoteste3.mp4" type="video/mp4">
      <!-- Adicione mais formatos de vídeo aqui, se necessário -->
    </video>
  </div>

  <main>
    <!-- Seu conteúdo aqui -->
    <img src="#" alt="pokemon" class="pokemon__image">
    <h1 class="pokemon__data">
      <span class="pokemon__number"></span> -
      <span class="pokemon__name"></span>
    </h1>
    <form class="form">
      <input
        type="search"
        class="input__search"
        placeholder="Nome ou Numero"
        required
      />
    </form>
    <div class="buttons">
      <button class="button btn-prev">Anterior &lt;</button>
      <button class="button btn-next">Próximo &gt;</button>
    </div>
    <img src="#" alt="pokedex" class="pokedex">
  </main>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const pokedexImage = document.querySelector('.pokedex');
      const pokemonTeam = localStorage.getItem('pokemonTeam');

      if (pokemonTeam) {
        switch (pokemonTeam) {
          case 'red':
            pokedexImage.src = "./images/pokedex.png";
            break;
          case 'blue':
            pokedexImage.src = "./images/pokedexazul.png";
            break;
          case 'yellow':
            pokedexImage.src = "./images/pokedexamarela.png";
            break;
          default:
            pokedexImage.src = "./images/pokedex.png";
        }

        // Agora que a equipe foi definida, renderize o Pokémon inicial
        renderPokemon(searchPokemon);
      }
    });

    // Funções para renderizar os Pokémon
    const pokemonName = document.querySelector('.pokemon__name');
    const pokemonNumber = document.querySelector('.pokemon__number');
    const pokemonImage = document.querySelector('.pokemon__image');

    const form = document.querySelector('.form');
    const input = document.querySelector('.input__search');
    const buttonPrev = document.querySelector('.btn-prev');
    const buttonNext = document.querySelector('.btn-next');

    let searchPokemon = 1;

    const fetchPokemon = async (pokemon) => {
      const APIResponse = await fetch(`https://pokeapi.co/api/v2/pokemon/${pokemon}`);

      if (APIResponse.status === 200) {
        const data = await APIResponse.json();
        return data;
      }
    }

    const renderPokemon = async (pokemon) => {

      pokemonName.innerHTML = 'Loading...';
      pokemonNumber.innerHTML = '';

      const data = await fetchPokemon(pokemon);

      if (data) {
        pokemonImage.style.display = 'block';
        pokemonName.innerHTML = data.name;
        pokemonNumber.innerHTML = data.id;
        pokemonImage.src = data['sprites']['versions']['generation-v']['black-white']['animated']['front_default'];
        input.value = '';
        searchPokemon = data.id;
      } else {
        pokemonImage.style.display = 'none';
        pokemonName.innerHTML = 'Not found :c';
        pokemonNumber.innerHTML = '';
      }
    }

    form.addEventListener('submit', (event) => {
      event.preventDefault();
      renderPokemon(input.value.toLowerCase());
    });

    buttonPrev.addEventListener('click', () => {
      if (searchPokemon > 1) {
        searchPokemon -= 1;
        renderPokemon(searchPokemon);
      }
    });

    buttonNext.addEventListener('click', () => {
      searchPokemon += 1;
      renderPokemon(searchPokemon);
    });

    // Adicione um evento de clique para as imagens das equipes para definir a equipe selecionada e mostrar a imagem da Pokédex
    document.querySelectorAll('.team-image').forEach((image) => {
      image.addEventListener('click', (event) => {
        const selectedTeam = event.target.alt.split(' ')[1].toLowerCase();
        localStorage.setItem('pokemonTeam', selectedTeam); // Definindo a equipe selecionada no armazenamento local
        // Redirecionando para a página da Pokédex
        window.location.href = "pokedex.html";
      });
    });
  </script>
</body>
</html>
