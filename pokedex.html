<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pokédex</title>
  <link rel="stylesheet" href="./style.css">

</head>
<body class="index-body">
  <div id="video-background">
    <video autoplay loop muted class="video-background">
      <source src="/images/fundoteste3.mp4" type="video/mp4">
      <!-- Adicione mais formatos de vídeo aqui, se necessário -->
    </video>
  </div>

  <main>
    <!-- Seu conteúdo aqui -->
    <div class="pokemon-info">
      <img src="#" alt="pokemon" class="pokemon__image">
      <h1 class="pokemon__data">
        <span class="pokemon__number"></span> -
        <span class="pokemon__name"></span>
      </h1>
    </div>
    <form class="form">
      <input
        type="search"
        class="input__search"
        placeholder="Nome ou Numero"
        required
      />
    </form>
    <div class="buttons">
      <button class="button btn-stats">Estatísticas</button> 
      <button class="button btn-prev">Anterior &lt;</button>
      <button class="button btn-next">Próximo &gt;</button>
    </div>
    
    <img src="#" alt="pokedex" class="pokedex">
    <img class="estatisticas" src="./images/estatisticas.png" alt="Estatisticas">

    <div class="pokemon-stats-container" style="display:none;">
      <div class="pokemon-stats">
        <!-- Aqui serão exibidas as estatísticas -->
      </div>
    </div>
  </main>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const pokedexImage = document.querySelector('.pokedex');
      const pokemonTeam = localStorage.getItem('pokemonTeam');
      let searchPokemon = 1;

      if (pokemonTeam) {
        switch (pokemonTeam) {
          case 'red':
            pokedexImage.src = "./images/pokedex.png";
            break;
          case 'blue':
            pokedexImage.src = "./images/pokedexazul.png";
            break;
          case 'yellow':
            pokedexImage.src = "./images/pokedexamarela.png";
            break;
          default:
            pokedexImage.src = "./images/pokedex.png";
        }

        // Agora que a equipe foi definida, renderize o Pokémon inicial
        renderPokemon(searchPokemon);
      }
    });

    // Funções para renderizar os Pokémon
    const pokemonName = document.querySelector('.pokemon__name');
    const pokemonNumber = document.querySelector('.pokemon__number');
    const pokemonImage = document.querySelector('.pokemon__image');
    const form = document.querySelector('.form');
    const input = document.querySelector('.input__search');
    const buttonPrev = document.querySelector('.btn-prev');
    const buttonNext = document.querySelector('.btn-next');
    const buttonStats = document.querySelector('.btn-stats');
    const pokemonStatsContainer = document.querySelector('.pokemon-stats');
    const statsList = document.querySelector('.stats-list');

    const fetchPokemon = async (pokemon) => {
      const APIResponse = await fetch(`https://pokeapi.co/api/v2/pokemon/${pokemon}`);

      if (APIResponse.status === 200) {
        const data = await APIResponse.json();
        return data;
      }
    }

    const fetchPokemonStats = async (pokemon) => {
      const data = await fetchPokemon(pokemon);

      if (data) {
        return data.stats.map(stat => `${stat.stat.name}: ${stat.base_stat}`);
      } else {
        console.error('Erro ao buscar estatísticas do Pokémon');
        return [];
      }
    }

    const renderPokemon = async (pokemon) => {
      pokemonName.innerHTML = 'Loading...';
      pokemonNumber.innerHTML = '';

      const data = await fetchPokemon(pokemon);

      if (data) {
        pokemonImage.style.display = 'block';
        pokemonName.innerHTML = data.name;
        pokemonNumber.innerHTML = data.id;
        pokemonImage.src = data.sprites.versions['generation-v']['black-white'].animated.front_default;
        input.value = '';
        searchPokemon = data.id;
      } else {
        pokemonImage.style.display = 'none';
        pokemonName.innerHTML = 'Not found :c';
        pokemonNumber.innerHTML = '';
      }
    }

    form.addEventListener('submit', (event) => {
      event.preventDefault();
      renderPokemon(input.value.toLowerCase());
    });

    buttonPrev.addEventListener('click', () => {
      if (searchPokemon > 1) {
        searchPokemon -= 1;
        renderPokemon(searchPokemon);
      }
    });

    buttonNext.addEventListener('click', () => {
      searchPokemon += 1;
      renderPokemon(searchPokemon);
    });

    buttonStats.addEventListener('click', async () => {
      const stats = await fetchPokemonStats(searchPokemon);
      displayPokemonStats(stats);
    });

    const displayPokemonStats = (stats) => {
  const pokemonStatsContainer = document.querySelector('.pokemon-stats-container');
  const statsList = document.querySelector('.pokemon-stats');

  if (stats.length > 0) {
    statsList.innerHTML = ''; // Limpa a lista antes de adicionar as novas estatísticas

    stats.forEach(stat => {
      const statElement = document.createElement('h2');
      statElement.textContent = stat;
      statsList.appendChild(statElement);
    });

    pokemonStatsContainer.style.display = 'flex';
  } else {
    pokemonStatsContainer.style.display = '';
  }

  buttonNext.addEventListener('click', () => {
  searchPokemon += 1;
  // Oculta o contêiner de estatísticas ao avançar para o próximo Pokémon
  pokemonStatsContainer.style.display = 'none';
  renderPokemon(searchPokemon);
});

buttonPrev.addEventListener('click', () => {
  if (searchPokemon > 1) {
    searchPokemon -= 1;
    // Oculta o contêiner de estatísticas ao retroceder para o Pokémon anterior
    pokemonStatsContainer.style.display = 'none';
    renderPokemon(searchPokemon);
  }
});

}

  </script>
</body>
</html>
